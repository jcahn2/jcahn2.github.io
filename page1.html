<!DOCTYPE html>
<html>
    <!-- Load d3.js -->
    <script src='https://d3js.org/d3.v5.min.js'></script>
    <!-- Load d3-annotation -->
    <script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>


    <!-- load chart script -->
    <script src="d3Chart.js"></script>

    <!-- load csv -->
    <script>
        async function init() {
            const data = await d3.csv("https://jcahn2.github.io/Mastercard_stock_history.csv",
                function(d) {return {
                                Date: d3.timeParse("%Y-%m-%d")(d.Date),
                                Open: +d.Open,
                                High: +d.High,
                                Low: +d.Low,
                                Close: +d.Close,
                                Volume: +d.Volume
                                    }
                            }
            );
            ticker_start = data.slice(-130);
            
            ticker2008 = data.filter(function(d){
                return (
                    d.Date >= d3.timeParse("%Y-%m-%d")("2008-09-01") &&
                    d.Date <= d3.timeParse("%Y-%m-%d")("2008-12-01")
                )
            });

            ticker2015 = data.filter(function(d){
                return (
                    d.Date >= d3.timeParse("%Y-%m-%d")("2015-06-01") &&
                    d.Date <= d3.timeParse("%Y-%m-%d")("2016-03-01")
                )
            });

            ticker2018 = data.filter(function(d){
                return (
                    d.Date >= d3.timeParse("%Y-%m-%d")("2018-01-01") &&
                    d.Date <= d3.timeParse("%Y-%m-%d")("2018-05-20")
                )
            });

            ticker2020 = data.filter(function(d){
                return (
                    d.Date >= d3.timeParse("%Y-%m-%d")("2020-01-01") &&
                    d.Date <= d3.timeParse("%Y-%m-%d")("2020-06-25")
                )
            });
            // ticker1 = data.slice(-200);


            chart('.container',ticker_start);
        }
    </script>

    <!-- button functions -->
    <script>
        function chart2008() {
            d3.selectAll('svg').remove();
            chart('.container',ticker2008);

            // change year title
            document.getElementById("yearTitle")
                .innerHTML = "2008";

        }
        
        function chart2015() {
            d3.selectAll('svg').remove();
            chart('.container',ticker2015);

            // change year title
            document.getElementById("yearTitle")
                .innerHTML = "2015";

        }

        function chart2018() {
            d3.selectAll('svg').remove();
            chart('.container',ticker2018);

            // change year title
            document.getElementById("yearTitle")
                .innerHTML = "2018";
        }

        function chart2020() {
            d3.selectAll('svg').remove();
            chart('.container',ticker2020);

            // change year title
            document.getElementById("yearTitle")
                .innerHTML = "2020";
        }
    </script>

    <body onload="init()">
        <div>
            <h1>Title Here</h1>
        </div>
        <div>
            <h3 id="yearTitle">Year</h3>
            <p>
                "description about drop in stocks for this year"
            </p>
        </div>
        <button onClick="chart2008()">
            2008
        </button>
        <button onClick="chart2015()">
            2015
        </button>
        <button onClick="chart2018()">
            2018
        </button>
        <button onClick="chart2020()">
            2020
        </button>

        <div class="container"></div>
        <div id="tooltip"></div>
        <div id="annotation"></div>
    </body>

</html>

